package com.minori.hrm.services.impl;

import java.util.Optional;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Component;

import com.minori.hrm.converter.TimeOffConverter;
import com.minori.hrm.models.MasterLeaveReason;
import com.minori.hrm.models.User;
import com.minori.hrm.models.WktLeaveRequest;
import com.minori.hrm.repositorys.MasterLeaveReasonRepository;
import com.minori.hrm.repositorys.UserRepository;
import com.minori.hrm.repositorys.WktLeaveRequestRepository;
import com.minori.hrm.request.CreateTimeOffRequest;
import com.minori.hrm.response.CreateTimeOffResponse;
import com.minori.hrm.services.TimeOffService;

@Component
public class TimeOffServiceImpl implements TimeOffService{
	
	@Autowired
	private UserRepository userRepository;
	
	@Autowired
	private TimeOffConverter timeOffConverter;
	
	@Autowired
	private MasterLeaveReasonRepository masterLeaveResonRepository;
	
	@Autowired
	private WktLeaveRequestRepository wktleaveRequestRepository;
	
	@Override
	public Optional<CreateTimeOffResponse> createTimeOff(CreateTimeOffRequest request){
		User user = userRepository.findByUsername(request.getUserName());
		WktLeaveRequest result = wktleaveRequestRepository.save(timeOffConverter.convertEntity(request, user));
		
		Optional<CreateTimeOffResponse> response = timeOffConverter.convertCreateTimeOffResponse(result);
		
		return response;
	}

}
